<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/styles.css"> <!-- 引入 CSS 樣式表 -->
    <title>NVIDIA辦公需求留言板</title>
</head>

<body>
    <h1>NVIDIA辦公需求留言板</h1>
    <div>
        <form id="messageForm" onsubmit="submitForm(); return false;">
            <label for="name">您的名稱 (UserName):</label>
            <input type="text" id="name" required>
            <br>
            <label for="tool">需要何項工具 (Which Tool):</label>
            <input type="text" id="tool" required>
            <br>
            <label for="link">工具網站鏈接 (Tool Link):</label>
            <input type="text" id="link" required>
            <br>
            <label for="quantity">數量 (Quantity):</label>
            <input type="number" id="quantity" required>
            <br>
            <button type="submit">留言 (Message)</button>
        </form>
    </div>

    <div id="messages"></div>

    <script>
        async function submitForm() {
            var name = document.getElementById('name').value;
            var tool = document.getElementById('tool').value;
            var link = document.getElementById('link').value;
            var quantity = document.getElementById('quantity').value;

            const response = await fetch('/addMessage', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    name,
                    tool,
                    link,
                    quantity
                }),
            });

            const data = await response.json();

            if (data.success) {
                alert('留言成功！');
                // 如果需要更新留言列表，可添加相應的程式碼
                updateMessages();
            } else {
                alert('留言失敗！');
            }
        }

        async function updateMessages() {
            const response = await fetch('/getMessages');
            const data = await response.json();

            const messagesDiv = document.getElementById('messages');
            messagesDiv.innerHTML = ''; // 清空原有的留言

            data.messages.forEach(message => {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message');

                const nameDiv = document.createElement('div');
                nameDiv.classList.add('name');
                nameDiv.textContent = `留言者： ${message.name}`;
                messageDiv.appendChild(nameDiv);

                const toolDiv = document.createElement('div');
                toolDiv.classList.add('tool');
                toolDiv.textContent = `工具： ${message.tool}`;
                messageDiv.appendChild(toolDiv);

                const linkDiv = document.createElement('div');
                linkDiv.classList.add('link');
                linkDiv.textContent = `工具網站鏈接： ${message.link}`;
                messageDiv.appendChild(linkDiv);

                const quantityDiv = document.createElement('div');
                quantityDiv.classList.add('quantity');
                quantityDiv.textContent = `數量： ${message.quantity}`;
                messageDiv.appendChild(quantityDiv);

                messagesDiv.appendChild(messageDiv);
            });
        }

        // 初始載入時更新留言列表
        updateMessages();
    </script>
</body>

</html>
